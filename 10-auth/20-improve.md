move requireAuth into ProtectedLayout.astro then.
replace all missing-user requests to /login 
remove any other redirect logic from lower layers (unless necessary)